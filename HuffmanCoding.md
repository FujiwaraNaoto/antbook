<!-- 
Ctrl + K の後に V

ABC252
-->
<!--
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script>
-->
## ハフマン符号　

以下の証明はハフマン符号がコンパクト符号である事の証明とほぼ同一です。

準備

繋げる過程 (最初と最後含む) で出てくる板を頂点とし、最初の板を葉、最後に一つながりになった板を根とし、根以外の板についてその板を繋げた先の板を親として持つような根付き木を考えます。このとき、この根付き木の葉以外の頂点はかならずちょうど 
2
2 つの子を持っています。

また、各頂点の重みをその頂点に対応する板の長さで定めると、繋げる過程全体でかかったコストは葉以外の頂点の重みの総和として表されます。このとき、葉以外の頂点について、その重みは子の重みの和となっていることに注意します。さらに、それぞれの葉の重みがその祖先において何回加算されたかを考えることで、これはそれぞれの葉について（重み）
×
×（根付き木における深さ）を足し合わせたものとしても数えられることが分かります。

よって、コストを最小にするような繋げ方に対応する木においては、重みが小さい方から 
2
2 つの葉を取ってきたとき、それら木の中で深さが最大の 
2
2 頂点であるとしてよいです。（ここで、葉でない頂点が必ず 
2
2 つの子を持つことから最大の深さの頂点は 
2
2 つ以上存在することに注意）なぜなら、そうでない時、葉の重みを入れ替えることを考える事で全体のコストをより小さくできるからです。さらに、これらは同じ親を持つとしてよいです。なぜなら、同じ深さの葉同士を入れ替えても全体でコストは変わらないからです。

## 証明
$N$についての帰納法

(i) $N$=2の時

この時は繋げる操作が 1 通りしかないため、明らかである。

(ii) $N=N_{0}$で成立しているとして$N=N_{0}+1$の時

$A_{1},A_{2},...A_{N_{0}+1}$ を繋げる時のコストの最小値を$C'$とする.また、ここで、$A_{1},A_{2}$が$A_{1},A_{2},...A_{N_{0}+1}$の中で小さい方から二つとしても一般性を失わない.
なぜならば
$A_{1}+A_{2},A_{3},A_{4},...A_{N_{0}+1}$をつなげる際のコストの最小値を$C$とすると,帰納法の仮定より上の手法でつなげた時のコストの総和は$C + A_{1}+A_{2}$となる.従って,$C' \leq C +  A_{1}+A_{2} $が成り立つ.一方で $A_{1},A_{2},...A_{N_{0}+1}$をつなげる際のコストを最小にするつなげ方に対応する木を考えると,上の準備で述べたように,重さ$A_{1},A_{2}$の葉を子としてもつ頂点が存在する.この時この二つの葉を取り除くことで
$A_{1}+A_{2},A_{3},A_{4},...A_{N_{0}+1}$をつなげる方法に対応する木となります.この木に対応するコストは$C' - A_{1}-A_{2}$であるから$C \leq C' - A_{1}-A_{2}$より$C＋A_{1}+A_{2} \leq C' $である.ゆえに$C'=C＋A_{1}+A_{2}$ であり,上の手法はそれを達成している.証明が完了した.